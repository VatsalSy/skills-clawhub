{
  "version": "1.0.0",
  
  "scope": {
    "repos": {
      "mode": "allowlist",
      "allowed": [],
      "denied": []
    },
    "branches": {
      "protected": ["main", "master", "production", "develop", "release/*"],
      "workPrefix": "fix-issue-",
      "allowCustomPrefix": true
    },
    "paths": {
      "denied": [
        ".env",
        ".env.*",
        "*.pem",
        "*.key",
        "*.secret",
        "secrets/",
        ".github/workflows/",
        ".gitlab-ci.yml",
        "Jenkinsfile",
        "Dockerfile",
        "docker-compose*.yml",
        ".openclaw/",
        "node_modules/",
        "__pycache__/",
        ".git/",
        ".gitmodules",
        ".gitattributes"
      ],
      "denyPatterns": [
        "**/credentials*",
        "**/token*",
        "**/.env*",
        "**/secret*"
      ]
    },
    "files": {
      "denyModify": [
        "package.json",
        "package-lock.json",
        "yarn.lock",
        "pnpm-lock.yaml",
        "requirements.txt",
        "Pipfile.lock",
        "go.mod",
        "go.sum",
        "Cargo.toml",
        "Cargo.lock",
        "Gemfile.lock",
        "setup.py",
        "setup.cfg",
        "pyproject.toml",
        "Makefile",
        "CMakeLists.txt",
        "Dockerfile",
        "docker-compose.yml"
      ],
      "requireApprovalToModify": true
    }
  },

  "gates": {
    "clone_repo":        { "level": "notify",  "message": "Cloning repository..." },
    "read_issue":        { "level": "auto",    "message": null },
    "read_code":         { "level": "auto",    "message": null },
    "write_code":        { "level": "approve", "message": "About to modify code. Review diff?" },
    "run_tests":         { "level": "notify",  "message": "Running tests..." },
    "git_commit":        { "level": "approve", "message": "Ready to commit. Review changes?" },
    "git_push":          { "level": "approve", "message": "Ready to push. Confirm?" },
    "create_pr":         { "level": "approve", "message": "Ready to create PR. Review and confirm?" },
    "install_deps":      { "level": "approve", "message": "Wants to install dependencies. Allow?" },
    "modify_dep_file":   { "level": "approve", "message": "Wants to modify dependency file. Allow?" },
    "delete_file":       { "level": "approve", "message": "Wants to delete a file. Allow?" },
    "run_command":       { "level": "approve", "message": "Wants to run a command. Allow?" }
  },

  "commands": {
    "allowed": [
      "git clone",
      "git checkout",
      "git checkout -b",
      "git add",
      "git commit",
      "git push",
      "git push -u origin",
      "git diff",
      "git status",
      "git branch",
      "git log",
      "git stash",
      "git stash pop",
      "gh issue view",
      "gh issue list",
      "gh pr create",
      "gh pr view",
      "gh pr list",
      "npm test",
      "npm run lint",
      "npm run build",
      "npx jest",
      "npx vitest",
      "pytest",
      "python -m pytest",
      "python3 -m pytest",
      "go test",
      "cargo test",
      "make test",
      "cat",
      "grep",
      "find",
      "ls",
      "head",
      "tail",
      "wc",
      "diff",
      "echo",
      "mkdir",
      "cp",
      "mv"
    ],
    "blocked": [
      "rm -rf",
      "rm -r",
      "sudo",
      "curl",
      "wget",
      "ssh",
      "scp",
      "git push --force",
      "git push -f",
      "git push --mirror",
      "git push --delete",
      "git rebase",
      "git reset --hard",
      "git reset --merge",
      "git clean",
      "git filter-branch",
      "git stash drop",
      "git stash clear",
      "git checkout --",
      "git checkout -f",
      "git credential",
      "git remote add",
      "git remote set-url",
      "git submodule",
      "git am",
      "git apply",
      "--upload-pack",
      "--exec",
      "core.sshCommand",
      "core.gitProxy",
      "alias.",
      "chmod",
      "chown",
      "kill",
      "pkill",
      "killall",
      "eval",
      "exec",
      "source",
      "export",
      "env",
      "printenv",
      "open",
      "pbcopy",
      "pbpaste",
      "bash",
      "sh",
      "zsh",
      "fish",
      "csh",
      "dash",
      "python3 -c",
      "python -c",
      "node -e",
      "perl -e",
      "ruby -e",
      "osascript",
      "crontab",
      "at ",
      "launchctl",
      "nohup",
      "screen",
      "tmux",
      "nc ",
      "ncat",
      "socat",
      "telnet",
      "ftp",
      "sftp",
      "rsync",
      "dd ",
      "yes ",
      "xargs",
      "doas",
      "su ",
      "pkexec",
      "set -",
      "npm run pre",
      "npm run post"
    ],
    "blockPatterns": [
      ".*&&.*rm.*",
      ".*\\|.*sh",
      ".*>.*\\.env.*",
      ".*>.*secret.*",
      ".*base64.*decode.*"
    ]
  },

  "behavior": {
    "oneIssueAtATime": true,
    "maxDiffLines": 200,
    "timeoutMinutes": 15,
    "draftPRByDefault": true,
    "noForceEver": true,
    "noSelfModify": true,
    "autoRollbackOnTestFail": true,
    "requireTestPass": true,
    "dryRunDefault": false
  },

  "audit": {
    "enabled": true,
    "logDir": "audit",
    "logActions": true,
    "logDiffs": true,
    "logDecisions": true,
    "retentionDays": 30
  }
}
